<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="840" viewBox="0 0 1280 840">
  <style>
    .title { font: 700 22px sans-serif; fill: #222 }
    .h { font: 600 16px sans-serif; fill: #222 }
    .t { font: 12px sans-serif; fill: #222 }
    .box { fill: #fff; stroke: #666; stroke-width: 1.2 }
    .group { fill: #f7f9fc; stroke: #c7d3e3; stroke-width: 1.2 }
    .ds { fill: #fffdf5; stroke: #bfa86a; stroke-width: 1.2 }
    .kafka { fill: #f9f5ff; stroke: #b79de6; stroke-width: 1.2 }
    .arrow { stroke: #555; stroke-width: 1.2; marker-end: url(#arrowhead) }
    .event { stroke: #7a5af8; stroke-dasharray: 4 4; marker-end: url(#arrowheadPurple) }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 8 3, 0 6" fill="#555" />
    </marker>
    <marker id="arrowheadPurple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 8 3, 0 6" fill="#7a5af8" />
    </marker>
  </defs>

  <text class="title" x="30" y="40">NovaPOS Architecture Overview</text>

  <!-- Frontends Group -->
  <rect class="group" x="20" y="70" width="380" height="180" rx="8" />
  <text class="h" x="30" y="95">Frontends</text>
  <rect class="box" x="40" y="115" width="160" height="60" rx="6" />
  <text class="h" x="50" y="140">POS Edge Client</text>
  <text class="t" x="50" y="160">React PWA (offline)</text>

  <rect class="box" x="220" y="115" width="160" height="60" rx="6" />
  <text class="h" x="230" y="140">Admin Portal</text>
  <text class="t" x="230" y="160">Management UI</text>

  <!-- Kafka -->
  <rect class="kafka" x="460" y="120" width="180" height="120" rx="8" />
  <text class="h" x="470" y="145">Kafka (events)</text>
  <text class="t" x="470" y="165">order.completed</text>
  <text class="t" x="470" y="182">order.voided</text>
  <text class="t" x="470" y="199">payment.completed</text>

  <!-- Services Group -->
  <rect class="group" x="680" y="70" width="580" height="420" rx="8" />
  <text class="h" x="690" y="95">Microservices (Rust)</text>

  <!-- Row 1 services -->
  <rect class="box" x="700" y="115" width="160" height="60" rx="6" />
  <text class="h" x="710" y="140">Auth</text>
  <text class="t" x="710" y="160">JWT, roles</text>

  <rect class="box" x="880" y="115" width="160" height="60" rx="6" />
  <text class="h" x="890" y="140">Product</text>
  <text class="t" x="890" y="160">Catalog/Price</text>

  <rect class="box" x="1060" y="115" width="180" height="60" rx="6" />
  <text class="h" x="1070" y="140">Inventory</text>
  <text class="t" x="1070" y="160">Stock/Reserve</text>

  <!-- Row 2 services -->
  <rect class="box" x="700" y="195" width="160" height="60" rx="6" />
  <text class="h" x="710" y="220">Order</text>
  <text class="t" x="710" y="240">Totals, receipts</text>

  <rect class="box" x="880" y="195" width="160" height="60" rx="6" />
  <text class="h" x="890" y="220">Payment</text>
  <text class="t" x="890" y="240">Card/Crypto</text>

  <rect class="box" x="1060" y="195" width="180" height="60" rx="6" />
  <text class="h" x="1070" y="220">Integration GW</text>
  <text class="t" x="1070" y="240">Webhooks/APIs</text>

  <!-- Row 3 services -->
  <rect class="box" x="700" y="275" width="160" height="60" rx="6" />
  <text class="h" x="710" y="300">Customer</text>
  <text class="t" x="710" y="320">PII encrypted</text>

  <rect class="box" x="880" y="275" width="160" height="60" rx="6" />
  <text class="h" x="890" y="300">Loyalty</text>
  <text class="t" x="890" y="320">Points/events</text>

  <rect class="box" x="1060" y="275" width="180" height="60" rx="6" />
  <text class="h" x="1070" y="300">Analytics</text>
  <text class="t" x="1070" y="320">Insights/AI</text>

  <!-- Datastores Group -->
  <rect class="group" x="20" y="300" width="620" height="220" rx="8" />
  <text class="h" x="30" y="325">Infrastructure</text>

  <rect class="ds" x="40" y="345" width="180" height="60" rx="8" />
  <text class="h" x="50" y="370">PostgreSQL</text>
  <text class="t" x="50" y="390">Multi-tenant (tenant_id)</text>

  <rect class="ds" x="240" y="345" width="160" height="60" rx="8" />
  <text class="h" x="250" y="370">Redis</text>
  <text class="t" x="250" y="390">Cache/Rate limit</text>

  <rect class="ds" x="420" y="345" width="200" height="60" rx="8" />
  <text class="h" x="430" y="370">Vault</text>
  <text class="t" x="430" y="390">Secrets/Envelope</text>

  <!-- Arrows: Frontends -> Services (REST) -->
  <line class="arrow" x1="200" y1="145" x2="700" y2="145" />
  <line class="arrow" x1="380" y1="145" x2="700" y2="145" />
  <text class="t" x="420" y="135">REST/JWT + X-Tenant-ID</text>

  <!-- Arrows: Services <-> Kafka (events) -->
  <line class="event" x1="590" y1="180" x2="700" y2="225" />
  <line class="event" x1="590" y1="150" x2="700" y2="150" />
  <line class="event" x1="640" y1="220" x2="700" y2="290" />
  <text class="t" x="540" y="210">Async events</text>

  <!-- Arrows: Services -> Datastores -->
  <line class="arrow" x1="780" y1="255" x2="130" y2="375" />
  <line class="arrow" x1="960" y1="255" x2="320" y2="375" />
  <line class="arrow" x1="1140" y1="255" x2="520" y2="375" />

  <!-- Legend -->
  <rect class="group" x="20" y="550" width="1240" height="260" rx="8" />
  <text class="h" x="30" y="575">Legend & Notes</text>
  <circle cx="40" cy="600" r="6" fill="#555" />
  <text class="t" x="55" y="604">Solid arrow: synchronous REST/HTTP</text>
  <circle cx="40" cy="630" r="6" fill="#7a5af8" />
  <text class="t" x="55" y="634">Purple dashed arrow: Kafka event</text>
  <text class="t" x="30" y="664">Topics (examples): order.completed, order.voided, payment.completed</text>
  <text class="t" x="30" y="694">Security: JWT (RS256), X-Tenant-ID header, per-tenant encryption keys (Vault)</text>
  <text class="t" x="30" y="724">Data: PostgreSQL with tenant_id; Redis for cache/limiting</text>
  <text class="t" x="30" y="754">Deploy: Containers on Docker/Kubernetes; IaC with Terraform</text>
</svg>
